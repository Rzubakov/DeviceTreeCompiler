<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:h="http://java.sun.com/jsf/html"
      xmlns:f="http://java.sun.com/jsf/core"
      xmlns:p="http://primefaces.org/ui"
      xmlns:ui="http://java.sun.com/jsf/facelets">
    <ui:composition template="/layouts/home.xhtml">
        <ui:define name="title">Модули</ui:define> 
        <ui:define name="content">
            <h:form id="form">
                <div class="ui-g-12 ui-md-4 ui-lg-4">
                    <p:dataTable var="controller" value="#{modulesBean.controllers}"  selectionMode="single" selection="#{modulesBean.selectedController}" rowKey="#{controller.id}">
                        <p:ajax event="rowSelect"  update="form:modules" />
                        <p:column headerText="Наименование">
                            <h:outputText value="#{controller.id}:#{controller.name}" />
                        </p:column>
                    </p:dataTable>      
                </div>
                <div class="ui-g-12 ui-md-8 ui-lg-8">
                    <p:dataTable id="modules" var="module" value="#{modulesBean.selectedController.modules}"  >
                        <p:column width="30">
                            <p:graphicImage library="images" name="#{module.name}.png" width="30"/>
                        </p:column> 
                        <p:column headerText="id">
                            <h:outputText value="#{module.id}" />
                        </p:column> 
                        <p:column headerText="size">
                            <h:outputText value="#{module.currentSize}/#{module.size}" />
                        </p:column>     
                        <p:column headerText="index">
                            <h:outputText value="#{module.index}" />
                        </p:column>
                        <p:column headerText="Имя">
                            <h:outputText value="#{module.name}" />
                        </p:column> 
                        <p:column headerText="ts_vname">
                            <h:outputText value="#{module.ts_vname}" />
                        </p:column>  
                        <p:column headerText="vname">
                            <h:outputText value="#{module.vname}" />
                        </p:column>   
                        <p:column headerText="kind">
                            <h:outputText value="#{module.kind}" />
                        </p:column>  
                        <p:column style="width:50px;text-align: center">
                            <p:commandButton update="@form"  icon="ui-icon-trash" title="Удалить" actionListener="#{modulesBean.deleteModule(module)}" />            
                        </p:column>                      
                        <f:facet name="footer">
                            <p:commandButton  update="modules" value="DI32" actionListener="#{modulesBean.addModule('DI32')}"   disabled="#{modulesBean.selectedController == null}" />
                            <p:commandButton  update="modules" value="DO32" actionListener="#{modulesBean.addModule('DO32')}"   disabled="#{modulesBean.selectedController == null}" />
                            <p:commandButton  update="modules" value="AIG16" actionListener="#{modulesBean.addModule('AIG16')}" disabled="#{modulesBean.selectedController == null}" />
                        </f:facet>
                    </p:dataTable>      
                </div>
            </h:form> 

        </ui:define> 
    </ui:composition>    
</html>    
